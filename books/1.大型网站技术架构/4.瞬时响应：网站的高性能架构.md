### 4. 网站的高性能架构
#### 1. 网站性能测试
- 性能测试指标
  - 响应时间：执行一个请求需要的时间，通常一个请求重复多次取平均值；
  - 并发数：指系统同时处理请求的数目，通过多线程并发来测试；
  - 吞吐量：指单位时间内系统处理的请求数量，通过TPS(每秒事务数)、QPS(每秒查询数)、HPS(每秒HTTP请求数)来衡量
 - 性能计数器：是描述服务器或操作系统性能的一组数据。如：System load、对象与线程数、CPU使用、磁盘IO、网络IO等；
- 性能测试方法：
  - 性能测试
  - 负载测试
  - 压力测试
  - 稳定性测试：
#### 2. Web前端性能优化
- 浏览器访问优化
  - 减少http请求
  - 使用浏览器缓存
  - 启用压缩
  - CSS、JS放在页面最下面
  - 减少Cookie传输
- CDN加速
- 反向代理(缓存)
#### 3. 应用服务器性能优化
应用服务器优化的主要手段：缓存、集群、异步；<br>
网站性能优化第一定律：**++优先考虑使用缓存优化性能。++**
- 分布式缓存
  - 数据分片存储、一致性Hash
  - Memcached：
    - 简单的通信协议(TCP)
    - 丰富的客户端，JAVA、C/C++/C#、Perl、Python、PHP、Ruby；
    - 高效的内存管理
    - 互不通信的服务器集群架构，方便伸缩；
- 异步操作
  - 使用消息队列改善网站扩展性和性能；
- 使用集群
  - 提高系统的并发处理能； 
- 代码优化
  - 使用多线程提升系统处理能力；
    - 将对象设计为无状态；
    - 使用局部对象；
    - 并发访问资源使用锁；
  - 资源复用
    - 资源复用的两种模式：单例和对象池
  - 数据结构
    - 程序就是数据结构+算法，合理应用提升性能；
  - 垃圾回收
    - JVM 内存主要分为堆和栈；堆分为年轻的和老年代；年轻的Young GC 对象复制超过一定阈值会将该对复制到老年代，老年代满了会进行 full GC,full GC 对系统性能影响很大，要合理设置年轻代和老年代的空间大小。
#### 4. 存储性能优化
- 机械硬盘 VS 固态硬盘(SSD)
  - SSD 速度快、功耗小、噪声低；
- B+树 VS LSM树
  - B+树 对数据排序后存储，加快检索速度；LSM树许多NoSQL 产品采用，可以减少磁盘访问次数，加快访问效率；
- RAID VS HDFS
  - RAID(廉价磁盘冗余阵列)、HDFS(Hadoop分布式文件系统)